# Using Feature Alignment Can Improve Clean Average Precision and Adversarial Robustness in Object Detection

Paper:https://arxiv.org/abs/2012.04382

This repository contains two parts: one is experiments on YOLO-V3 in folder yolov3-adv, the other is experiments on FASTER-RCNN-FPN in folder faster-rcnn-fpn-adv.


## Clone Code
```
git clone https://github.com/grispeut/Feature-Alignment.git
```

## YOLO-V3

Follow the README in [yolov3-adv](https://github.com/grispeut/Feature-Alignment/tree/main/yolov3-adv/README.md) to reproduce our experiments.

### On Pascal VOC

+ standard training

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| STD  | 0.780 | 0.258 | 0.051 | 0.024 | 0.010 | 0.086 | 0.433 |

+ trained with PGD-1

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| AT   | 0.724 | 0.301 | 0.187 | 0.167 | 0.148 | 0.201 | 0.463 | 
| TOD  | 0.702 | 0.298 | 0.195 | 0.177 | 0.163 | 0.208 | 0.455 |            
| KDFA | 0.739 | 0.327 | 0.200 | 0.179 | 0.162 | 0.217 | 0.478 |           
| SSFA | 0.730 | 0.297 | 0.175 | 0.152 | 0.133 | 0.189 | 0.460 |        
| FA   | 0.745 | 0.329 | 0.200 | 0.178 | 0.161 | 0.217 | 0.481 |        


+ trained with PGD-2

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| AT   | 0.665 | 0.277 | 0.209 | 0.196 | 0.186 | 0.217 | 0.441 |          
| TOD  | 0.659 | 0.285 | 0.219 | 0.208 | 0.199 | 0.228 | 0.444 |           
| KDFA | 0.702 | 0.315 | 0.229 | 0.213 | 0.201 | 0.240 | 0.471 |          
| SSFA | 0.693 | 0.293 | 0.210 | 0.196 | 0.185 | 0.221 | 0.457 |         
| FA   | 0.712 | 0.319 | 0.231 | 0.213 | 0.202 | 0.241 | 0.477 |           


+ trained with PGD-3

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| AT   | 0.604 | 0.251 | 0.194 | 0.183 | 0.176 | 0.201 | 0.403 |
| TOD  | 0.581 | 0.249 | 0.200 | 0.190 | 0.183 | 0.206 | 0.394 |           
| KDFA | 0.672 | 0.301 | 0.231 | 0.219 | 0.210 | 0.240 | 0.456 |       
| SSFA | 0.653 | 0.281 | 0.214 | 0.203 | 0.194 | 0.223 | 0.438 |          
| FA   | 0.677 | 0.305 | 0.231 | 0.218 | 0.209 | 0.241 | 0.459 |   

### On MS-COCO

+ standard training

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| STD  | 0.545 | 0.189 | 0.041 | 0.022 | 0.009 | 0.065 | 0.305 |

+ trained with PGD-1

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| AT   | 0.490 | 0.187 | 0.077 | 0.056 | 0.037 | 0.089 | 0.290 | 
| TOD  | 0.488 | 0.191 | 0.073 | 0.052 | 0.035 | 0.088 | 0.288 |            
| KDFA | 0.506 | 0.209 | 0.098 | 0.075 | 0.059 | 0.110 | 0.308 |           
| SSFA | 0.499 | 0.202 | 0.089 | 0.068 | 0.051 | 0.103 | 0.301 |        
| FA   | 0.510 | 0.213 | 0.109 | 0.087 | 0.070 | 0.120 | 0.315 |

## FASTER-RCNN-FPN

Follow the README in [faster-rcnn-fpn-adv](https://github.com/grispeut/Feature-Alignment/tree/main/faster-rcnn-fpn-adv/README.md) to reproduce our experiments.

### On Pascal VOC

+ standard training

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| STD  | 0.835 | 0.265 | 0.009 | 0.002 | 0.002 | 0.070 | 0.453 |

+ trained with PGD-1

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| AT   | 0.834 | 0.189 | 0.065 | 0.035 | 0.007 | 0.074 | 0.454 | 
| TOD  | 0.833 | 0.309 | 0.073 | 0.037 | 0.006 | 0.106 | 0.470 |            
| KDFA | 0.833 | 0.354 | 0.103 | 0.059 | 0.015 | 0.133 | 0.483 |           
| SSFA | 0.833 | 0.345 | 0.078 | 0.053 | 0.015 | 0.123 | 0.478 |        
| FA   | 0.834 | 0.480 | 0.109 | 0.064 | 0.010 | 0.166 | 0.500 |        


+ trained with PGD-2

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| AT   | 0.824 | 0.548 | 0.209 | 0.154 | 0.031 | 0.236 | 0.530 |          
| TOD  | 0.828 | 0.579 | 0.224 | 0.161 | 0.024 | 0.247 | 0.538 |           
| KDFA | 0.828 | 0.645 | 0.241 | 0.178 | 0.029 | 0.273 | 0.551 |          
| SSFA | 0.829 | 0.623 | 0.235 | 0.178 | 0.033 | 0.267 | 0.548 |         
| FA   | 0.832 | 0.664 | 0.256 | 0.189 | 0.033 | 0.286 | 0.559 |           


+ trained with PGD-3

| model performance                   |  clean AP | PGD-1 | PGD-3 | PGD-5 | PGD-10 | advAP | acAP |
| :-----------------: |:-----------------: |:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|:-----------------:|
| AT   | 0.822 | 0.281 | 0.153 | 0.103 | 0.009 | 0.137 | 0.480 |
| TOD  | 0.821 | 0.367 | 0.184 | 0.131 | 0.010 | 0.173 | 0.497 |           
| KDFA | 0.823 | 0.452 | 0.232 | 0.164 | 0.018 | 0.217 | 0.520 |       
| SSFA | 0.824 | 0.404 | 0.202 | 0.141 | 0.012 | 0.190 | 0.507 |          
| FA   | 0.825 | 0.545 | 0.265 | 0.191 | 0.039 | 0.260 | 0.543 | 

